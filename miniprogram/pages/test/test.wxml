<!--pages/test/test.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æµ‹è¯•ç»“æœ -->
  <view wx:elif="{{finished}}" class="result">
    <text class="result-icon">{{result.accuracy >= 60 ? 'ğŸ‰' : 'ğŸ’ª'}}</text>
    <text class="result-title">æµ‹è¯•å®Œæˆ!</text>
    <view class="result-stats">
      <view class="stat-item">
        <text class="stat-value">{{result.total}}</text>
        <text class="stat-label">æ€»é¢˜æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{result.correct}}</text>
        <text class="stat-label">æ­£ç¡®æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{result.accuracy}}%</text>
        <text class="stat-label">æ­£ç¡®ç‡</text>
      </view>
    </view>
    <button class="btn-back" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
  </view>

  <!-- æµ‹è¯•å†…å®¹ -->
  <view wx:else class="test-content">
    <!-- è¿›åº¦ -->
    <view class="progress">
      <text>ç¬¬ {{currentIndex + 1}} / {{questions.length}} é¢˜</text>
    </view>

    <!-- é¢˜ç›® -->
    <view class="question-card">
      <view class="word-info">
        <text class="word">{{currentQuestion.word}}</text>
        <text class="phonetic">{{currentQuestion.phonetic}}</text>
      </view>
      <text class="question-text">è¯·é€‰æ‹©æ­£ç¡®çš„é‡Šä¹‰:</text>
    </view>

    <!-- é€‰é¡¹ -->
    <view class="options">
      <block wx:for="{{currentQuestion.options}}" wx:key="id">
        <view 
          class="option-item {{selectedOption === item.id ? 'selected' : ''}}"
          bindtap="selectOption"
          data-id="{{item.id}}"
        >
          <text class="option-label">{{index === 0 ? 'A' : index === 1 ? 'B' : index === 2 ? 'C' : 'D'}}</text>
          <text class="option-text">{{item.meaning}}</text>
        </view>
      </block>
    </view>

    <!-- æäº¤æŒ‰é’® -->
    <button class="btn-submit" bindtap="submitAnswer">
      {{currentIndex < questions.length - 1 ? 'ä¸‹ä¸€é¢˜' : 'æäº¤æµ‹è¯•'}}
    </button>
  </view>
</view>